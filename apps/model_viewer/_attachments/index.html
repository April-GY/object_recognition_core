<!doctype html>
<head>
<script src="js/Three.js"></script>
<script src="js/plane.js"></script>
<script src="js/thingiview.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script>
  function get_list_of_urls(){
	  $.getJSON("/object_recognition/_design/models/_view/by_object_id_and_mesh",
			  function(data) {
		      console.info(data.rows);
			    $.each(data.rows, function(key,val){
			    	console.info(val);
			       $("<a/>").attr("href", "?mesh=" + val.id).text(val.id).appendTo("#links");
			       $("<br/>").appendTo("#links");
			    });
			  });
  }
  
  function getUrlVars()
  {
      var vars = {}, hash;
      var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
      for(var i = 0; i < hashes.length; i++)
      {
          hash = hashes[i].split('=');
          console.info(hash);
          vars[hash[0]] = hash[1];
      }
      return vars;
  }
  window.onload = function()
  {
	  get_list_of_urls();
	  var vars = getUrlVars();
	  console.info(vars);
		thingiurlbase = "js";
		thingiview = new Thingiview("viewer");
		thingiview.setObjectColor('#C0D8F0');
		thingiview.initScene();
		thingiview
				.loadSTL("/object_recognition/" + vars.mesh + "/mesh.stl");
		thingiview.setCameraView('diagonal');
		thingiview.setRotation(true);
		thingiview.setObjectMaterial('solid');
	}
</script>
<div id="viewer" style="width: 50%; height: 400px"></div>
<div id="links" style="width: 50%; height: 400px"></div>

</head>
<body>
	<div id="viewer" style="width: 50%; height: 400px"></div>
</body>
</html>

